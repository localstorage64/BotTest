KGZ1bmN0aW9uKCkgewoKICAgICd1c2Ugc3RyaWN0JzsKCiAgICBjb25zdCBkZWxheXMgPSBbMTAw
MF07IC8vIG1zCgogICAgbGV0IGRyYXdpbmcgPSBmYWxzZTsKCiAgICBsZXQgY3VycmVudFgsIGN1
cnJlbnRZOwoKICAgIC8vID09PSBQYW5lbCA9PT0KCiAgICBjb25zdCBwYW5lbCA9IGRvY3VtZW50
LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOwoKICAgIHBhbmVsLnN0eWxlLnBvc2l0aW9uID0gJ2ZpeGVk
JzsKCiAgICBwYW5lbC5zdHlsZS50b3AgPSAnMTBweCc7CgogICAgcGFuZWwuc3R5bGUucmlnaHQg
PSAnMTBweCc7CgogICAgcGFuZWwuc3R5bGUuYmFja2dyb3VuZCA9ICcjMjIyJzsKCiAgICBwYW5l
bC5zdHlsZS5jb2xvciA9ICcjZmZmJzsKCiAgICBwYW5lbC5zdHlsZS5wYWRkaW5nID0gJzEwcHgn
OwoKICAgIHBhbmVsLnN0eWxlLnpJbmRleCA9ICc5OTk5JzsKCiAgICBwYW5lbC5zdHlsZS5mb250
U2l6ZSA9ICcxMnB4JzsKCiAgICBwYW5lbC5zdHlsZS53aWR0aCA9ICcxMjZweCc7CgogICAgcGFu
ZWwuc3R5bGUuYm9yZGVyID0gJzFweCBzb2xpZCAjNTU1JzsKCiAgICBwYW5lbC5zdHlsZS5jdXJz
b3IgPSAnZ3JhYic7CgogIGxldCBkcmFnID0gZmFsc2UsIG9mZlggPSAwLCBvZmZZID0gMDsKCnBh
bmVsLmFkZEV2ZW50TGlzdGVuZXIoIm1vdXNlZG93biIsIGUgPT4gewogIGRyYWcgPSB0cnVlOwog
IG9mZlggPSBlLmNsaWVudFggLSBwYW5lbC5vZmZzZXRMZWZ0OwogIG9mZlkgPSBlLmNsaWVudFkg
LSBwYW5lbC5vZmZzZXRUb3A7Cn0pOwoKZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigibW91c2Vt
b3ZlIiwgZSA9PiB7CiAgaWYgKCFkcmFnKSByZXR1cm47CiAgcGFuZWwuc3R5bGUubGVmdCA9IChl
LmNsaWVudFggLSBvZmZYKSArICJweCI7CiAgcGFuZWwuc3R5bGUudG9wID0gKGUuY2xpZW50WSAt
IG9mZlkpICsgInB4IjsKfSk7Cgpkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCJtb3VzZXVwIiwg
KCkgPT4gZHJhZyA9IGZhbHNlKTsKCnBhbmVsLmFkZEV2ZW50TGlzdGVuZXIoInRvdWNoc3RhcnQi
LCBlID0+IHsKICBkcmFnID0gdHJ1ZTsKICBjb25zdCB0ID0gZS50b3VjaGVzWzBdOwogIG9mZlgg
PSB0LmNsaWVudFggLSBwYW5lbC5vZmZzZXRMZWZ0OwogIG9mZlkgPSB0LmNsaWVudFkgLSBwYW5l
bC5vZmZzZXRUb3A7Cn0pOwoKZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigidG91Y2htb3ZlIiwg
ZSA9PiB7CiAgaWYgKCFkcmFnKSByZXR1cm47CiAgY29uc3QgdCA9IGUudG91Y2hlc1swXTsKICBw
YW5lbC5zdHlsZS5sZWZ0ID0gKHQuY2xpZW50WCAtIG9mZlgpICsgInB4IjsKICBwYW5lbC5zdHls
ZS50b3AgPSAodC5jbGllbnRZIC0gb2ZmWSkgKyAicHgiOwp9KTsKCmRvY3VtZW50LmFkZEV2ZW50
TGlzdGVuZXIoInRvdWNoZW5kIiwgKCkgPT4gZHJhZyA9IGZhbHNlKTsKCiAgICBwYW5lbC5pbm5l
ckhUTUwgPSBgCgogICAgICAgIDxiPlB4Qm90IDAuMjwvYj48YnI+CgogICAgICAgIDxpbnB1dCBp
ZD0iY29vcmRYIiB0eXBlPSJudW1iZXIiIHZhbHVlPSIiIHN0eWxlPSJ3aWR0aDo2MHB4IiBwbGFj
ZWhvbGRlcj0iWCBjb29yZCI+IFgKCiAgICAgICAgPGlucHV0IGlkPSJjb29yZFkiIHR5cGU9Im51
bWJlciIgdmFsdWU9IiIgc3R5bGU9IndpZHRoOjYwcHgiIHBsYWNlaG9sZGVyPSJZIGNvb3JkIj4g
WSA8YnI+CgogICAgICAgIDxidXR0b24gaWQ9ImJ0bl9zdGFydCI+U3RhcnQ8L2J1dHRvbj4KCiAg
ICAgICAgPGJ1dHRvbiBpZD0iYnRuX3N0b3AiPlN0b3A8L2J1dHRvbj4KCiAgICAgICAgPGhyPgoK
ICAgICAgICA8ZGl2IGlkPSJsb2dEaXYiIHN0eWxlPSJtYXgtaGVpZ2h0OjI3cHg7b3ZlcmZsb3c6
YXV0bztiYWNrZ3JvdW5kOmRhcmtibHVlO3BhZGRpbmc6M3B4OyI+PC9kaXY+CgogICAgYDsKCiAg
ICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKHBhbmVsKTsKCiAgICBmdW5jdGlvbiBsb2cobXNn
LCB0eXBlPSJpbmZvIikgewoKICAgICAgICBjb25zdCBsb2dEaXYgPSBkb2N1bWVudC5nZXRFbGVt
ZW50QnlJZCgnbG9nRGl2Jyk7CgogICAgICAgIGNvbnN0IHRpbWUgPSBuZXcgRGF0ZSgpLnRvTG9j
YWxlVGltZVN0cmluZygpOwoKICAgICAgICBjb25zdCBjb2xvciA9IHR5cGUgPT09ICJlcnJvciIg
PyAicmVkIiA6ICJ3aGl0ZSI7CgogICAgICAgIGxvZ0Rpdi5pbm5lckhUTUwgKz0gYDxzcGFuIHN0
eWxlPSJjb2xvcjoke2NvbG9yfSI+WyR7dGltZX1dICR7bXNnfTwvc3Bhbj48YnI+YDsKCiAgICAg
ICAgbG9nRGl2LnNjcm9sbFRvcCA9IGxvZ0Rpdi5zY3JvbGxIZWlnaHQ7CgogICAgfQoKCiAgICBm
dW5jdGlvbiB3cmFwQ29vcmQodmFsdWUpIHsKCiAgICAgICAgaWYgKHZhbHVlID4gNjU1MzYpIHJl
dHVybiAtMTsKCiAgICAgICAgaWYgKHZhbHVlIDwgLTY1NTM2KSByZXR1cm4gMTsKCiAgICAgICAg
cmV0dXJuIHZhbHVlOwoKICAgIH0KCiAgICBmdW5jdGlvbiBwbGFjZVBpeGVsKHgsIHkpIHsKCiAg
ICAgICAgY29uc3QgY2FudmFzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignY2FudmFzJyk7Cgog
ICAgICAgIGlmICghY2FudmFzKSB7CgogICAgICAgICAgICBsb2coIkNhbnZhcyBub3QgZm91bmQi
LCAiZXJyb3IiKTsKCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKCiAgICAgICAgfQoKICAgICAg
ICBjb25zdCByZWN0ID0gY2FudmFzLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpOwoKICAgICAgICBj
b25zdCBjZW50ZXJYID0gcmVjdC5sZWZ0ICsgcmVjdC53aWR0aCAvIDI7CgogICAgICAgIGNvbnN0
IGNlbnRlclkgPSByZWN0LnRvcCArIHJlY3QuaGVpZ2h0IC8gMjsKCiAgICAgICAgY29uc3QgZXZl
bnRJbml0ID0gewoKICAgICAgICAgICAgYnViYmxlczogdHJ1ZSwKCiAgICAgICAgICAgIGNhbmNl
bGFibGU6IHRydWUsCgogICAgICAgICAgICBjbGllbnRYOiBjZW50ZXJYLAoKICAgICAgICAgICAg
Y2xpZW50WTogY2VudGVyWSwKCiAgICAgICAgICAgIGJ1dHRvbjogMAoKICAgICAgICB9OwoKICAg
ICAgICBjYW52YXMuZGlzcGF0Y2hFdmVudChuZXcgTW91c2VFdmVudCgnbW91c2Vkb3duJywgZXZl
bnRJbml0KSk7CgogICAgICAgIGNhbnZhcy5kaXNwYXRjaEV2ZW50KG5ldyBNb3VzZUV2ZW50KCdt
b3VzZXVwJywgZXZlbnRJbml0KSk7CgogICAgICAgIHJldHVybiB0cnVlOwoKICAgIH0KCgoKCiAg
ICBmdW5jdGlvbiByYW5kb21EZWxheSgpIHsKCiAgICAgICAgcmV0dXJuIGRlbGF5c1tNYXRoLmZs
b29yKE1hdGgucmFuZG9tKCkgKiBkZWxheXMubGVuZ3RoKV07CgogICAgfQoKCiAgICBmdW5jdGlv
biBkcmF3U3RlcCgpIHsKCiAgICAgICAgaWYgKCFkcmF3aW5nKSByZXR1cm47CgogICAgICAgIGN1
cnJlbnRYID0gd3JhcENvb3JkKGN1cnJlbnRYICsgMSk7CgogICAgICAgIGNvbnN0IHpvb20gPSAz
MzsKCiAgICAgICAgY29uc3QgaGFzaCA9IGAjZCwke2N1cnJlbnRYfSwke2N1cnJlbnRZfSwke3pv
b219YDsKCiAgICAgICAgd2luZG93LmxvY2F0aW9uLmhhc2ggPSBoYXNoOwoKICAgICAgICBpZiAo
cGxhY2VQaXhlbChjdXJyZW50WCwgY3VycmVudFkpKSB7CgogICAgICAgICAgICBsb2coYHBsYWNl
IDxicj4gJHtjdXJyZW50WH0sJHtjdXJyZW50WX1gKTsKCiAgICAgICAgfQoKICAgICAgICBzZXRU
aW1lb3V0KGRyYXdTdGVwLCByYW5kb21EZWxheSgpKTsKCiAgICB9CgogICAgZG9jdW1lbnQuZ2V0
RWxlbWVudEJ5SWQoJ2J0bl9zdGFydCcpLm9uY2xpY2sgPSAoKSA9PiB7CgogICAgICAgIGlmICgh
ZHJhd2luZykgewoKICAgICAgICAgICAgY3VycmVudFggPSBwYXJzZUludChkb2N1bWVudC5nZXRF
bGVtZW50QnlJZCgnY29vcmRYJykudmFsdWUpOwoKICAgICAgICAgICAgY3VycmVudFkgPSBwYXJz
ZUludChkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY29vcmRZJykudmFsdWUpOwoKICAgICAgICAg
ICAgZHJhd2luZyA9IHRydWU7CgogICAgICAgICAgICBsb2coImJ1aWxkXzEiKTsKCiAgICAgICAg
ICAgIGRyYXdTdGVwKCk7CgogICAgICAgIH0KCiAgICB9OwoKICAgIGRvY3VtZW50LmdldEVsZW1l
bnRCeUlkKCdidG5fc3RvcCcpLm9uY2xpY2sgPSAoKSA9PiB7CgogICAgICAgIGRyYXdpbmcgPSBm
YWxzZTsKCiAgICAgICAgbG9nKCJidWlsZF8wIik7CgogICAgfTsKfSkoKTs=
